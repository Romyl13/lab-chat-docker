<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Ö—ñ–¥ –¥–æ –ß–∞—Ç—É</title>
    <style>
        /* --- 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CSS –ó–º—ñ–Ω–Ω–∏—Ö (–¥–ª—è —Ç–µ–º–Ω–æ—ó/—Å–≤—ñ—Ç–ª–æ—ó —Ç–µ–º–∏) --- */
        :root {
            --bg-color: #f4f4f4;
            --container-bg: white;
            --text-color: #333;
            --border-color: #ccc;
            --button-bg: #007bff;
            --button-hover: #0056b3;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        body.dark-mode {
            --bg-color: #1a1a1a;
            --container-bg: #2b2b2b;
            --text-color: #f1f1f1;
            --border-color: #555;
            --button-bg: #0056b3;
            --button-hover: #003d80;
            --shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        /* --- –ö—ñ–Ω–µ—Ü—å –ó–º—ñ–Ω–Ω–∏—Ö --- */

        body {
            font-family: sans-serif;
            display: grid;
            place-items: center;
            min-height: 90vh;
            background: var(--bg-color); /* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∑–º—ñ–Ω–Ω—É */
            color: var(--text-color); /* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∑–º—ñ–Ω–Ω—É */
            transition: background 0.3s, color 0.3s;
            margin: 0;
            padding: 1rem;
        }
        
        #theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
        }

        .container {
            background: var(--container-bg);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            
            /* --- –¶–ï –ê–î–ê–ü–¢–ò–í --- */
            width: 90%; /* –ù–∞ –º–æ–±—ñ–ª—å–Ω–æ–º—É –±—É–¥–µ 90% —à–∏—Ä–∏–Ω–∏ –µ–∫—Ä–∞–Ω—É */
            max-width: 350px; /* –ê–ª–µ –Ω–µ —à–∏—Ä—à–µ, –Ω—ñ–∂ 350px –Ω–∞ –ü–ö */
        }
        
        h1 { text-align: center; margin-top: 0; }
        form { display: flex; flex-direction: column; gap: 10px; }
        
        label { font-size: 0.9em; }
        
        input {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color); /* –†–æ–±–∏–º–æ —Ñ–æ–Ω —ñ–Ω–ø—É—Ç—ñ–≤ —è–∫ —Ñ–æ–Ω —Å—Ç–æ—Ä—ñ–Ω–∫–∏ */
            color: var(--text-color);
        }
        
        button {
            padding: 10px;
            background: var(--button-bg);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover { background: var(--button-hover); }
        
        #register-btn { background: #555; }
        #register-btn:hover { background: #333; }

        #response-message { margin-top: 15px; text-align: center; font-size: 0.9em; }
        .error { color: #ff5c5c; }
        .success { color: #5cff5c; }

        #sound-btn {
            margin-top: 20px;
            background: #28a745;
        }
        #sound-btn:hover { background: #1e7e34; }
    </style>
</head>
<body>

    <button id="theme-toggle">üåô</button>

    <div class="container">
        <h1>–í—Ö—ñ–¥ –∞–±–æ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h1>
        
        <form id="auth-form">
            <label for="username">–õ–æ–≥—ñ–Ω:</label>
            <input type="text" id="username" required>
            
            <label for="password">–ü–∞—Ä–æ–ª—å:</label>
            <input type="password" id="password" required>
            
            <button type="submit" id="login-btn">–£–≤—ñ–π—Ç–∏</button>
            <button type="button" id="register-btn">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
        </form>
        
        <div id="response-message"></div>

        <button type="button" id="sound-btn">–ó–¥–∞—Ä–æ–≤–∞, –±–∞–Ω–¥–∏—Ç–∏!</button>
    </div>

    <audio id="my-sound" src="https://www.myinstants.com/media/sounds/zdarova-bandity.mp3" preload="auto"></audio>

    <script>
        // --- 1. –°—Ç–∞—Ä–∏–π –∫–æ–¥ –¥–ª—è –ª–æ–≥—ñ–Ω—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó (–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å) ---
        const form = document.getElementById('auth-form');
        const loginBtn = document.getElementById('login-btn');
        const registerBtn = document.getElementById('register-btn');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const responseMsg = document.getElementById('response-message');

        registerBtn.onclick = async function(event) {
            // ... (–≤–µ—Å—å —Ç–≤—ñ–π –∫–æ–¥ 'fetch /register') ...
            event.preventDefault();
            const username = usernameInput.value;
            const password = passwordInput.value;

            const response = await fetch('/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username: username, password: password })
            });
            const data = await response.json();
            if (response.ok) {
                responseMsg.textContent = data.message;
                responseMsg.className = 'success';
            } else {
                responseMsg.textContent = data.detail;
                responseMsg.className = 'error';
            }
        };
        form.onsubmit = async function(event) {
            // ... (–≤–µ—Å—å —Ç–≤—ñ–π –∫–æ–¥ 'fetch /login' —ñ 'localStorage.setItem') ...
            event.preventDefault();
            const username = usernameInput.value;
            const password = passwordInput.value;

            const response = await fetch('/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username: username, password: password })
            });
            const data = await response.json();
            if (response.ok) {
                responseMsg.textContent = '–í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è...';
                responseMsg.className = 'success';
                localStorage.setItem('chat-token', data.access_token);
                setTimeout(() => { window.location.href = '/'; }, 1000);
            } else {
                responseMsg.textContent = data.detail;
                responseMsg.className = 'error';
            }
        };

        // --- 2. –ù–û–í–ò–ô –∫–æ–¥ –¥–ª—è –ó–≤—É–∫—É ---
        const soundBtn = document.getElementById('sound-btn');
        const mySound = document.getElementById('my-sound');
        soundBtn.onclick = function() {
            mySound.play(); // –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ –ø–æ –∫–ª—ñ–∫—É
        };

        // --- 3. –ù–û–í–ò–ô –∫–æ–¥ –¥–ª—è –¢–µ–º–Ω–æ—ó –¢–µ–º–∏ ---
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        // –ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –±—É–ª–∞ —Ç–µ–º–∞ –≤ 'localStorage'
        if (localStorage.getItem('chat-theme') === 'dark') {
            body.classList.add('dark-mode');
            themeToggle.textContent = '‚òÄÔ∏è'; // –ú—ñ–Ω—è—î–º–æ —ñ–∫–æ–Ω–∫—É
        }

        themeToggle.onclick = function() {
            body.classList.toggle('dark-mode'); // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ –∫–ª–∞—Å
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤–∏–±—ñ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('chat-theme', 'dark');
                themeToggle.textContent = '‚òÄÔ∏è';
            } else {
                localStorage.setItem('chat-theme', 'light');
                themeToggle.textContent = 'üåô';
            }
        };
    </script>
</body>
</html>